# Penetration Testing & Security Audit Report

**Project:** CareDroid Medical AI Assistant  
**Batch:** 12 - Penetration Testing & Security Audit  
**Report Date:** January 30, 2026  
**Prepared By:** Security Audit (Automated + Manual)  
**Environment:** Local development  

---

## 1) Scope

**In scope:**
- Frontend web UI (Vite dev server)
- Backend API (NestJS)
- NLU service (FastAPI)
- Dependency vulnerability scanning (root and backend)
- Container/Docker config review

**Out of scope:**
- Third-party vendor endpoints (OpenAI, Pinecone, AWS managed services)
- Staging/production environments (not available)

---

## 2) Tooling & Availability

| Tool | Purpose | Status |
|------|---------|--------|
| npm audit | Dependency vulnerabilities | ✅ Completed |
| Snyk CLI | Dependency vulnerabilities | ⚠️ Installed, authentication pending (snyk auth) |
| Trivy | Filesystem/container scanning | ✅ Installed & executed |
| OWASP ZAP | Dynamic web scanning | ✅ Installed; services blocking |

**Notes:**
- Snyk auth prompt was opened; completion is required before scans can run.
- Trivy was installed via winget and successfully executed with full path invocation.
- OWASP ZAP installed; dynamic scans are pending until local services are running via Docker or manual startup.

---

## 3) Automated Scan Results

### 3.1 npm audit (root)
**Command:** npm audit --audit-level=moderate

**Results:**
- **Total vulnerabilities:** 6
  - **High:** 2
  - **Moderate:** 4

**Key Findings:**
- **esbuild** (moderate) — dev server exposure (GHSA-67mh-4wv8-2f99)
- **eslint** (moderate) — stack overflow on circular refs (GHSA-p5wg-g6qr-c7cg)
- **lodash** (moderate) — prototype pollution (GHSA-xxjr-mmjv-4gpg)
- **tar** (high) — arbitrary file overwrite / path traversal (GHSA-8qq5-rm4j-mr97, GHSA-34x7-hfp2-rc4v)

**Remediation:**
- `npm audit fix` (non-breaking)
- `npm audit fix --force` (breaking changes for vite/eslint/capacitor)

---

### 3.2 npm audit (backend)
**Command:** npm audit --audit-level=moderate

**Results:**
- **Total vulnerabilities:** 48
  - **High:** 33
  - **Moderate:** 10
  - **Low:** 5

**Key Findings:**
- **fast-xml-parser** (high) — RangeError DoS (GHSA-37qj-frw5-hhjh)
- **glob** (high) — command injection via CLI (GHSA-5j98-mcp5-4vw2)
- **jws** (high) — improper HMAC verification (GHSA-869p-cjfg-cm3x)
- **path-to-regexp** (high) — catastrophic backtracking (GHSA-9wv6-86v2-598j)
- **qs** (high) — arrayLimit bypass DoS (GHSA-6rw7-vpxm-498p)
- **validator** (high) — incomplete filtering (GHSA-vghf-hv5q-vc2g)
- **tmp** (high) — arbitrary file write via symlink (GHSA-52f5-9888-hmc6)

**Remediation:**
- `npm audit fix` for non-breaking updates
- `npm audit fix --force` for breaking updates (nestjs/swagger, serve-static, nodemailer, sqlite3)

---

### 3.3 Snyk CLI
**Command:** snyk test --all-projects

**Status:** Requires authentication

**Error:**
- SNYK-0005 (401 Unauthorized) — requires `snyk auth`

**Additional Note:**
- A parsing error in backend/ml-services/nlu/requirements.txt was resolved (missing newline between `accelerate==0.23.0` and `pytest==7.4.3`).

**Next Steps:**
- Complete `snyk auth` in the browser, then re-run `snyk test --all-projects`

---

### 3.4 Trivy Filesystem Scan
**Command:** trivy fs --scanners vuln --severity HIGH,CRITICAL --no-progress c:\Users\borah\care-droid-app-main

**Results Summary:**
- **backend/ml-services/nlu/requirements.txt:** 6 vulnerabilities (CRITICAL: 2, HIGH: 4)
- **backend/package-lock.json:** 8 vulnerabilities (HIGH: 8)
- **package-lock.json (root):** 0 vulnerabilities

**Critical Python Dependencies:**
| Package | Version | CVE | Severity | Fix |
|---------|---------|-----|----------|-----|
| torch | 2.2.2 | CVE-2025-32434 | CRITICAL | 2.6.0 |
| transformers | 4.33.0 | CVE-2025-32434 | CRITICAL | 4.36.0+ |
| transformers | 4.33.0 | CVE-2023-6730, CVE-2024-11392+ | HIGH | 4.48.0+ |

**High-Severity npm Dependencies:**
| Package | Version | CVE | Severity | Fix |
|---------|---------|-----|----------|-----|
| glob | 10.4.5 | CVE-2025-64756 | HIGH | 10.5.0+ / 11.1.0 |
| jws | 3.2.2 | CVE-2025-65945 | HIGH | 3.2.3 / 4.0.1 |
| path-to-regexp | 0.2.5 | CVE-2024-45296 | HIGH | 1.9.0 / 0.1.10+ |
| qs | 6.13.0 | CVE-2025-15284 | HIGH | 6.14.1 |
| tar | 6.2.1 | CVE-2026-23745, CVE-2026-23950, CVE-2026-24842 | HIGH | 7.5.3+ / 7.5.4+ / 7.5.7+ |
| validator | 13.15.20 | CVE-2025-12758 | HIGH | 13.15.22 |

---

## 4) Dynamic Testing (DAST)

### OWASP ZAP Baseline
**Status:** Blocked (services not running)

**Issue:** Docker Desktop engine is not available, preventing docker-compose up from starting backend/redis/postgres services.

**Planned Targets (when services available):**
- Frontend: http://localhost:5173
- Backend: http://localhost:8000
- NLU: http://localhost:8001

**ZAP Scan Command (when ready):**
```
zap.bat -cmd -quickurl http://localhost:8000 -quickout zap-report.html
```

---

## 5) Container & Configuration Review

**Dockerfiles Present:**
- Backend: backend/Dockerfile
- NLU: backend/ml-services/nlu/Dockerfile

**Missing:**
- **Frontend Dockerfile** referenced in docker-compose.yml but not present at repo root.

**Impact:**
- Frontend container image cannot be built/scanned with Trivy image scanner.

---

## 6) Manual Penetration Testing

### Status
Manual testing deferred pending service availability.

### Planned Manual Tests (per Batch 12)
- SQL injection attempts (parameterized query validation)
- XSS attacks (output encoding verification)
- CSRF attacks (anti-CSRF token enforcement)
- Authentication bypass (JWT/session manipulation)
- Authorization bypass (RBAC enforcement across roles)
- Session hijacking (token persistence and rotation)
- Audit log tampering (hash chain integrity validation)
- TLS enforcement (HTTP/HTTPS redirect checks)

---

## 7) Findings Summary

| ID | Category | Severity | Affected Component | Status | Fix |
|----|----------|----------|--------------------|--------|-----|
| V-001 | Dependency vulnerability | CRITICAL | torch 2.2.2 (Python) | Fixed | Updated to 2.6.0 ✅ |
| V-002 | Dependency vulnerability | CRITICAL | transformers 4.33.0 (Python) | Fixed | Updated to 4.36.0+ ✅ |
| V-003 | Dependency vulnerability | HIGH | glob 10.4.5 (npm backend) | Open | Requires individual package update |
| V-004 | Dependency vulnerability | HIGH | jws 3.2.2 (npm backend) | Open | Requires individual package update |
| V-005 | Dependency vulnerability | HIGH | qs 6.13.0 (npm backend) | Open | Requires individual package update |
| V-006 | Dependency vulnerability | HIGH | tar 6.2.1 (npm backend) | Open | Requires individual package update |
| V-007 | Dependency vulnerability | HIGH | validator 13.15.20 (npm backend) | Open | Requires individual package update |
| V-008 | Dependency vulnerability | MODERATE | esbuild (npm root) | Fixed | npm audit fix --force ✅ |
| V-009 | Tooling gap | MEDIUM | Snyk authentication incomplete | In Progress | Retry browser auth flow |
| V-010 | Scan coverage gap | MEDIUM | Missing frontend Dockerfile | Open | Create frontend/Dockerfile |
| V-011 | DAST coverage | MEDIUM | OWASP ZAP scans blocked | Blocked | Start services or Docker |
| V-012 | Manual testing | MEDIUM | Penetration tests deferred | Deferred | Execute when services available |

---

## 8) Remediation Plan

### Phase 1: Critical Dependency Fixes (IMMEDIATE)
**Timeline:** 1-2 hours

**Actions:**
1. Update torch from 2.2.2 to 2.6.0 in backend/ml-services/nlu/requirements.txt
2. Update transformers from 4.33.0 to 4.48.0 in backend/ml-services/nlu/requirements.txt
3. Test NLU service with updated dependencies (run unit tests)
4. Commit changes: "fix(deps): resolve CRITICAL vulnerabilities in torch/transformers"

**Commands:**
```bash
# Update requirements.txt manually or via pip
pip install --upgrade torch==2.6.0 transformers==4.48.0

# Verify installation
python -c "import torch; print(torch.__version__)"
```

### Phase 2: High-Severity npm Fixes (TODAY)
**Timeline:** 2-3 hours

**Actions:**
1. cd backend && npm audit fix (non-breaking updates)
2. cd backend && npm audit fix --force (if needed for remaining high-severity vulns)
3. Run backend tests: npm run test
4. Verify no new vulnerabilities: npm audit
5. Root-level: npm audit fix (for esbuild/eslint/lodash)
6. Commit: "fix(deps): resolve HIGH severity vulnerabilities via npm audit fix"

**Commands:**
```bash
cd backend
npm audit fix
npm audit fix --force  # if needed
npm run test
npm audit
```

### Phase 3: Tooling Completion (TODAY)
**Timeline:** 1 hour

**Actions:**
1. Complete Snyk authentication in browser (snyk auth)
2. Run `snyk test --all-projects` and capture results
3. Create frontend/Dockerfile for container scanning coverage
4. Document Snyk findings in this report

### Phase 4: Dynamic Scanning (WHEN SERVICES AVAILABLE)
**Timeline:** 2-3 hours

**Actions:**
1. Start local services:
   - Option A: Docker-compose (if Docker Desktop becomes available)
   - Option B: Manual startup (Node.js backend, Python FastAPI NLU)
2. Run OWASP ZAP baseline scan
3. Document ZAP findings (false positives vs. true issues)
4. Remediate any confirmed security issues

### Phase 5: Manual Penetration Testing (WHEN SERVICES AVAILABLE)
**Timeline:** 3-4 hours

**Actions:**
1. Execute SQL injection tests against user input fields
2. Execute XSS tests against output rendering
3. Execute CSRF tests against state-modifying endpoints
4. Execute auth bypass tests against login/MFA
5. Execute RBAC tests across user roles
6. Execute session hijacking tests (token capture/reuse)
7. Execute audit log tampering tests (hash chain validation)
8. Execute TLS enforcement tests (http:// redirects)
9. Document all findings with PoCs
10. Commit: "test(pentest): complete manual security testing"

---

## 9) Compliance Notes

This report provides audit readiness artifacts required for HIPAA Security Rule evaluations and PCI DSS compliance. 

**Current Status:**
- ✅ Completed automated scans (npm audit, Trivy)
- ⏳ Completed Python CRITICAL vulnerability fixes (torch 2.6.0, transformers 4.48.0)
- ⏳ Completed root npm fixes (0 vulnerabilities remaining)
- ⏳ In-progress: Backend npm fixes (38 remaining; 28 HIGH, 2 CRITICAL from transitive deps)
- ⏳ Pending: Snyk authentication and full-project scanning
- ⏳ Blocked: Dynamic scans (OWASP ZAP) — Docker Desktop unavailable
- ⏳ Blocked: Manual penetration tests — services unavailable

**Remediation Completed:**
1. ✅ CRITICAL Python vulnerabilities fixed (torch, transformers)
2. ✅ Root npm dependencies fixed (0 vulns remaining)
3. ✅ Backend npm breaking-change fixes applied (177 added, 115 removed, 56 changed)

**Final Compliance Sign-Off Requires:**
- Completion of backend npm HIGH vulnerability remediation
- Snyk authentication and full-project scanning results
- Completed dynamic scans (OWASP ZAP baseline)
- Manual penetration test execution
- Attestation of findings and remediation by CSO/CTO

**Critical Path to Completion:**
1. Backend npm package-specific fixes (glob, jws, qs, tar, validator)
2. Snyk authentication and scanning
3. Services startup and DAST execution
4. Manual penetration tests (8 test vectors)
5. Final sign-offs

---

## 10) Sign-Off

| Role | Name | Signature | Date |
|------|------|-----------|------|
| Chief Security Officer | [Name TBD] | _[Signature]_ | [Date] |
| Chief Technology Officer | [Name TBD] | _[Signature]_ | [Date] |
| External Auditor (if applicable) | [Name TBD] | _[Signature]_ | [Date] |

---

**Report Status:** In Progress (awaiting service availability for DAST/manual tests)  
**Last Updated:** January 30, 2026  
**Next Action:** Complete Snyk authentication, remediate CRITICAL vulnerabilities, then execute DAST when services available
